#notes #backup #мысли
Примерные мысли такие. Для рекавери нам нужна вм, дата и конфиги.
Как сервер бекапов используем urbackup. С его помощью мы бекапим файлы из ВМок которые мы можем быстро востановить в случае чего, что бы уменьшить оверхед бекапа. На каждую ВМ создаем рекавери план. В основном мы имеем 3 вида файлов:
1) БД
2) Статика
3) Конфиги
На каждую ВМ делаем свою репу с бекапами. Хотелось бы все делать рестиком быстро и просто с дедупом, но сложно в управлении и не совмещаем образы ВМ и файлы. Можно написать автоматизацию для хапер ви через снапшоты, но очень много подводных. Это прям надо целый инструмент писать.
Для урбекапа надо проверить ограничения по скорости и  мультипоток. 
Настроить репы для файлов. Так же настроить репы для хранения тофу файлов. 
Подумать над автоматической раскаткой приложения. Очень много автоматизации, долго писать тяжело поддерживать.
Примерная блок схема 
Разверстка ВМ --> Добавление провижинига в репозиторий --> Определение директорий и файлов для бекапа --> Организация бекап-репы -- > Автоматизация бекапа
Схема говно надо переделать.
Добавить интеграцию бекапов в автоматизацию.
Надо сделать регистри контейнеров для наших систем.